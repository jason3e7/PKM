<html>
<head>
<link href="bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet">
<script type="text/javascript" src="jquery-3.1.1.min.js"></script>
</head>
<body>
<div class="container theme-showcase" role="main">
<h1>chinese cipher</h1>

<div class="form-group">
  <label for="key">key:</label>
  <input type="text" class="form-control" id="key" minlength="32" maxlength="32">
</div>
<div class="form-group">
  <label for="plaintext">plaintext:</label>
  <textarea class="form-control" rows="3" id="plaintext"></textarea>
</div>
<div class="form-group">
  <label for="ciphertext">ciphertext:</label>
  <textarea class="form-control" rows="3" id="ciphertext"></textarea>
</div>
<div class="form-group">
  <label for="output">output:</label>
  <textarea class="form-control" rows="3" id="output"></textarea>
</div>
<button type="button" id="encrypt" class="btn btn-default">encrypt</button>
<button type="button" id="decrypt" class="btn btn-default">decrypt</button>
</div>
<script type="text/javascript">

$("#encrypt").click(function() {
	var key = parseInt($("#key").val());
	var input = $("#plaintext").val();
	var output = "";
	var h = parseInt(input.length / key);
	if (input.length % key !== 0)
		h += 1;
	var subStr = [];
	for(i = 0; i < h; i++) {
		subStr[i] = input.substr(i * key, key);
	}
	//console.log(subStr);	
	for(j = 0; j < key; j++) {
		for(i = subStr.length - 1; i >= 0; i--) {
			if (typeof(subStr[i][j]) === 'undefined')
				continue;
			output += subStr[i][j];
		}
	}
	//console.log(output);
	$("#output").val(output);
});

$("#decrypt").click(function() {
	var key = parseInt($("#key").val());
	var input = $("#ciphertext").val();
	var output = "";
	var h = parseInt(input.length / key);
	var mod = input.length % key;
	//console.log(h,mod);
	var subStr = [];
	var start = 0;
	var len = 0;
	for(i = 0; i < key; i++) {
		len = h;
		if (mod > 0) {
			len++;
			mod--;
		}
		subStr[i] = input.substr(start, len);
		start += len;
	}
	//console.log(subStr);
	for(j = 1; j <= h + 1; j++) {
		for(i = 0; i < key; i++) {
			var char = subStr[i][subStr[i].length - j];
			if (typeof(char) === 'undefined')
				continue;
			output += char;
		}
	}
	//console.log(output);
	$("#output").val(output);
});
</script>
<script src="bootstrap-3.3.7/js/bootstrap.min.js"></script>
</body>
</html>
